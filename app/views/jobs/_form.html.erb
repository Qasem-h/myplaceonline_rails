<%= myp_text_field(f, :job_title, "myplaceonline.jobs.job_title", obj.job_title, autofocus) %>
<%= myp_text_field(f, :email, "myplaceonline.jobs.email", obj.email) %>
<%= myp_text_field(f, :employee_identifier, "myplaceonline.jobs.employee_identifier", obj.employee_identifier) %>
<%= myp_text_field(f, :department_name, "myplaceonline.jobs.department_name", obj.department_name) %>
<%= myp_text_field(f, :department_identifier, "myplaceonline.jobs.department_identifier", obj.department_identifier) %>
<%= myp_text_field(f, :division_name, "myplaceonline.jobs.division_name", obj.division_name) %>
<%= myp_text_field(f, :division_identifier, "myplaceonline.jobs.division_identifier", obj.division_identifier) %>
<%= myp_date_field(f, :started, "myplaceonline.jobs.started", obj.started) %>
<%= myp_date_field(f, :ended, "myplaceonline.jobs.ended", obj.ended) %>
<%= myp_integer_field(f, :days_vacation, "myplaceonline.jobs.days_vacation", obj.days_vacation) %>
<%= myp_integer_field(f, :days_holiday, "myplaceonline.jobs.days_holiday", obj.days_holiday) %>
<%= myp_text_field(f, :business_unit, "myplaceonline.jobs.business_unit", obj.business_unit) %>
<%= myp_text_field(f, :internal_mail_id, "myplaceonline.jobs.internal_mail_id", obj.internal_mail_id) %>
<%= myp_text_field(f, :internal_mail_server, "myplaceonline.jobs.internal_mail_server", obj.internal_mail_server) %>
<%= myp_text_field(f, :personnel_code, "myplaceonline.jobs.personnel_code", obj.personnel_code) %>
<%= myp_text_area_markdown(f, :notes, "myplaceonline.jobs.notes", obj.notes) %>
<%=
  render partial: 'myplaceonline/select_or_create', locals: {
    f: f,
    name: :company,
    existingobj: obj.company,
    heading: t("myplaceonline.jobs.company"),
    objform: "companies/form",
    existingobjurl: "company_path",
    searchurl: "/companies.json?perpage=0",
    edit: edit,
    autofocus: false
  }
%>
<%=
  render partial: 'myplaceonline/select_or_create', locals: {
    f: f,
    name: :manager_contact,
    existingobj: obj.manager_contact,
    heading: t("myplaceonline.jobs.manager_contact"),
    objform: "contacts/form",
    existingobjurl: "contact_path",
    searchurl: "/contacts.json?perpage=0",
    edit: edit,
    autofocus: false
  }
%>
<%=
  render layout: 'myplaceonline/childproperties', locals: {
    f: f,
    heading: t("myplaceonline.jobs.managers"),
    childpropertiesname: :job_managers,
    childproperties: obj.job_managers,
    deletebutton: t("myplaceonline.jobs.delete_manager"),
    addbutton: t("myplaceonline.jobs.add_manager"),
    expanded: obj.job_managers.length > 0,
    formjson: [
      {
        type: :renderpartial,
        name: :contact_attributes,
        partial: 'myplaceonline/select_or_create',
        heading: t("myplaceonline.jobs.manager"),
        objform: "contacts/form",
        existingobjurl: "contact_path",
        searchurl: "/contacts.json?perpage=0",
        edit: true,
        autofocus: true,
        force_existing: true,
        simpleform: true
      },
      {
        type: 'date',
        name: 'start_date',
        placeholder: t("myplaceonline.job_managers.start_date")
      },
      {
        type: 'date',
        name: 'end_date',
        placeholder: t("myplaceonline.job_managers.end_date")
      },
      {
        type: 'textarea',
        name: 'notes',
        placeholder: t("myplaceonline.general.notes")
      }
    ]
  } do |child_fields, childproperty|
%>
  <%=
    render partial: 'myplaceonline/select_or_create', locals: {
      f: child_fields,
      name: :contact_attributes,
      existingobj: childproperty.contact,
      heading: t("myplaceonline.jobs.manager"),
      objform: "contacts/form",
      existingobjurl: "contact_path",
      searchurl: "/contacts.json?perpage=0",
      edit: true,
      autofocus: false
    }
  %>
  <%= myp_date_field(child_fields, :start_date, "myplaceonline.job_managers.start_date", childproperty.start_date) %>
  <%= myp_date_field(child_fields, :end_date, "myplaceonline.job_managers.end_date", childproperty.end_date) %>
  <%= myp_text_area_markdown(child_fields, :notes, "myplaceonline.general.notes", childproperty.notes) %>
<% end %>
<%=
  render partial: 'myplaceonline/select_or_create', locals: {
    f: f,
    name: :internal_address,
    existingobj: obj.internal_address,
    heading: t("myplaceonline.jobs.internal_address"),
    objform: "locations/form",
    existingobjurl: "location_path",
    searchurl: "/locations.json?perpage=0",
    edit: edit,
    autofocus: false
  }
%>
<%=
  render layout: 'myplaceonline/childproperties', locals: {
    f: f,
    heading: t("myplaceonline.jobs.job_salaries"),
    childpropertiesname: :job_salaries,
    childproperties: obj.job_salaries,
    deletebutton: t("myplaceonline.jobs.delete_salary"),
    addbutton: t("myplaceonline.jobs.add_salary"),
    expanded: !edit || obj.job_salaries.length > 0,
    formjson: [
      {
        type: 'date',
        name: 'started',
        placeholder: t("myplaceonline.job_salaries.started")
      },
      {
        type: 'date',
        name: 'ended',
        placeholder: t("myplaceonline.job_salaries.ended")
      },
      {
        type: 'text',
        name: 'salary',
        placeholder: t("myplaceonline.job_salaries.salary")
      },
      {
        type: 'select',
        name: 'salary_period',
        options: Myp::PERIODS.map{|x,y| [I18n.t(x),y]}.as_json,
        placeholder: t("myplaceonline.job_salaries.salary_period")
      },
      {
        type: 'textarea',
        name: 'notes',
        placeholder: t("myplaceonline.job_salaries.notes")
      }
    ]
  } do |child_fields, childproperty|
%>
  <%= myp_date_field(child_fields, :started, "myplaceonline.job_salaries.started", childproperty.started) %>
  <%= myp_date_field(child_fields, :ended, "myplaceonline.job_salaries.ended", childproperty.ended) %>
  <%= myp_decimal_field(child_fields, :salary, "myplaceonline.job_salaries.salary", childproperty.salary) %>
  <%= myp_select(child_fields, :salary_period, "myplaceonline.job_salaries.salary_period", Myp.translate_options(Myp::PERIODS), childproperty.salary_period) %>
  <%= myp_text_area_markdown(child_fields, :notes, "myplaceonline.job_salaries.notes", childproperty.notes) %>
<% end %>
