<%= myp_datetime_field f, :meal_time, "myplaceonline.meals.meal_time", obj.meal_time %>
<%=
  render layout: 'myplaceonline/childproperties', locals: {
    f: f,
    heading: t("myplaceonline.foods.heading"),
    childpropertiesname: :meal_foods,
    childproperties: obj.meal_foods,
    deletebutton: t("myplaceonline.foods.delete"),
    addbutton: t("myplaceonline.foods.add"),
    expanded: true,
    formjson: [
      {
        type: :renderpartial,
        name: :food_attributes,
        partial: 'myplaceonline/select_or_create',
        heading: t("myplaceonline.foods.food"),
        objform: "foods/form",
        existingobjurl: "food_path",
        searchurl: "/foods.json?perpage=0",
        edit: false,
        autofocus: true
      }
    ]
  } do |child_fields, childproperty|
%>
  <%=
    render partial: 'myplaceonline/select_or_create', locals: {
      f: child_fields,
      name: :food_attributes,
      existingobj: childproperty.food,
      heading: t("myplaceonline.foods.food"),
      objform: "foods/form",
      existingobjurl: "food_path",
      searchurl: "/foods.json?perpage=0",
      edit: edit,
      autofocus: false
    }
  %>
<% end %>
<%=
  render layout: 'myplaceonline/childproperties', locals: {
    f: f,
    heading: t("myplaceonline.drinks.heading"),
    childpropertiesname: :meal_drinks,
    childproperties: obj.meal_drinks,
    deletebutton: t("myplaceonline.drinks.delete"),
    addbutton: t("myplaceonline.drinks.add"),
    expanded: true,
    formjson: [
      {
        type: 'text',
        name: 'drink_attributes.drink_name',
        placeholder: t("myplaceonline.drinks.drink_name"),
        autofocus: true
      },
      {
        type: 'number',
        name: 'drink_attributes.price',
        placeholder: t("myplaceonline.drinks.price"),
        step: Myp::DEFAULT_DECIMAL_STEP
      },
      {
        type: 'number',
        name: 'drink_attributes.calories',
        placeholder: t("myplaceonline.drinks.calories"),
        step: Myp::DEFAULT_DECIMAL_STEP
      },
      {
        type: 'textarea',
        name: 'drink_attributes.notes',
        placeholder: t("myplaceonline.drinks.notes")
      },
    ]
  } do |child_fields, childproperty|
%>
  <%= child_fields.fields_for :drink, childproperty.drink do |inner_child_fields| %>
    <%= myp_text_field inner_child_fields, :drink_name, "myplaceonline.drinks.drink_name", childproperty.drink.drink_name %>
    <%= myp_decimal_field inner_child_fields, :price, "myplaceonline.drinks.price", childproperty.drink.price %>
    <%= myp_decimal_field inner_child_fields, :calories, "myplaceonline.drinks.calories", childproperty.drink.calories %>
    <%= myp_text_area_markdown inner_child_fields, :notes, "myplaceonline.drinks.notes", childproperty.drink.notes %>
  <% end %>
<% end %>
<%= myp_text_field f, :price, "myplaceonline.meals.price", obj.price %>
<%= myp_text_field f, :calories, "myplaceonline.meals.calories", obj.calories %>
<%= myp_text_area_markdown f, :notes, "myplaceonline.meals.notes", obj.notes %>
<%=
  render partial: 'myplaceonline/select_or_create', locals: {
    f: f,
    name: :location,
    existingobj: obj.location,
    heading: t("myplaceonline.meals.location"),
    objform: "locations/form",
    existingobjurl: "location_path",
    searchurl: "/locations.json?perpage=0",
    edit: edit,
    autofocus: false,
    collapsed: obj.location.nil?
  }
%>
